---
inclusion: always
---

# 問題排除指導原則

## 問題分析方法

### 問題分類
1. **API 連接問題** - 網路、憑證、端點相關
2. **報告生成問題** - subprocess、檔案系統、依賴相關
3. **UI 問題** - 介面顯示、狀態同步、使用者互動
4. **配置問題** - 檔案讀寫、格式錯誤、預設值
5. **執行檔問題** - 打包、依賴、環境差異

### 診斷步驟
1. **重現問題** - 確認問題的具體表現和觸發條件
2. **檢查日誌** - 查看錯誤訊息和執行記錄
3. **隔離問題** - 確定問題發生在哪個模組
4. **測試驗證** - 使用測試工具驗證問題範圍

## 常見問題和解決方案

### API 連接問題
**症狀**: 無法載入專案資料、連接測試失敗
**可能原因**:
- 網路連接問題
- API Token 無效或過期
- Subdomain 設定錯誤
- API 端點變更

**解決步驟**:
1. 檢查網路連接
2. 驗證 API Token 和 Subdomain
3. 使用簡單的 API 測試腳本驗證
4. 檢查 Finite State 平台狀態

### 報告生成問題
**症狀**: 報告生成失敗、跳出額外視窗、檔案未產生
**可能原因**:
- fs-reporter 工具缺失或損壞
- subprocess 執行環境問題
- 輸出路徑權限問題
- 依賴模組缺失

**解決步驟**:
1. 確認 fs-reporter/main.py 存在
2. 檢查輸出目錄權限
3. 使用最簡單的 subprocess 方式
4. 檢查 Python 環境和依賴

### UI 問題
**症狀**: 介面無回應、狀態不更新、按鈕無效、文字被截斷
**可能原因**:
- 主執行緒阻塞
- 模組間狀態不同步
- tkinter 變數問題
- 事件綁定錯誤
- **垂直空間不足** - 容器高度不夠導致文字被截斷

**解決步驟**:
1. 確保長時間操作在背景執行緒執行
2. 使用 root.after() 更新 UI
3. 檢查變數綁定和事件處理
4. 測試模組化版本的狀態管理
5. **檢查垂直空間** - 使用固定高度容器和 pack_propagate(False)

### 執行檔問題
**症狀**: 執行檔無法啟動、功能異常、檔案過大
**可能原因**:
- PyInstaller 打包配置問題
- 依賴模組缺失或衝突
- 路徑處理差異
- 環境變數問題

**解決步驟**:
1. 檢查 PyInstaller 的 hidden-import 設定
2. 比較 Python 腳本和執行檔的行為差異
3. 使用最小化的打包配置
4. 測試不同的打包選項

## 問題預防策略

### 開發階段預防
- 每次修改後立即測試
- 使用模組化測試驗證功能
- 保持程式碼簡潔，避免過度複雜化
- 記錄重要的設計決策和限制

### 版本管理預防
- 基於穩定版本進行開發
- 避免同時修改多個模組
- 每次進版都要完整測試
- 保留可回滾的穩定版本

### 測試覆蓋預防
- 測試正常流程和異常情況
- 測試不同的輸入和配置
- 測試執行檔和 Python 腳本
- 定期執行完整的測試套件

## 問題處理流程

### 緊急問題處理
1. **立即回滾** - 回到最近的穩定版本
2. **隔離問題** - 確定問題的具體範圍
3. **快速修復** - 使用最簡單的解決方案
4. **驗證修復** - 確保問題已解決且無副作用

### 系統性問題處理
1. **深入分析** - 理解問題的根本原因
2. **設計解決方案** - 考慮長期的穩定性
3. **模組化修復** - 在獨立模組中實現修復
4. **全面測試** - 確保修復不影響其他功能

## 已知問題記錄

### 跳出視窗問題 (v1.0.2.004-006)
**問題**: 報告生成時會跳出額外的命令列視窗
**解決方案**: 使用直接整合方式，避免複雜的 subprocess 優化

### 檔案大小問題 (v1.0.2.008)
**問題**: 執行檔過大 (571MB)
**解決方案**: 使用混合架構，排除不必要的依賴模組

### API 連接錯誤 (v1.0.2.011-016)
**問題**: 各種 API 連接和資料處理錯誤
**解決方案**: 回滾到 v1.0.2.009 穩定版本，進行模組化重構

## 問題報告和追蹤

### 問題記錄格式
- **問題描述**: 具體的症狀和表現
- **重現步驟**: 如何觸發問題
- **環境信息**: 作業系統、Python 版本等
- **解決方案**: 採用的修復方法
- **測試結果**: 修復後的驗證結果

### 問題優先級
- **P0 - 緊急**: 核心功能完全無法使用
- **P1 - 高**: 重要功能受影響
- **P2 - 中**: 次要功能問題或使用體驗問題
- **P3 - 低**: 優化建議或非關鍵問題

### 問題追蹤原則
- 所有問題都要記錄在 CHANGELOG.md 中
- 重要問題要更新 steering rules
- 定期檢視和清理已解決的問題
- 分享問題解決經驗和最佳實踐