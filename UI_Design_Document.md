# TMflow Security Report Generator UI 設計文件

## 版本資訊
- **應用程式版本**: v1.0.2.002
- **UI 框架**: Python tkinter + ttk
- **設計主題**: 深色現代化主題
- **文件版本**: 2.0
- **最後更新**: 2026-02-03

## 設計概述

### 設計理念
TMflow Security Report Generator 採用現代化深色主題設計，提供專業、直觀的使用者介面。設計重點在於：
- **專業外觀**: 深色主題符合現代軟體設計趨勢
- **使用者友好**: 清晰的視覺層次和直觀的操作流程
- **功能完整**: 支援批量報告生成和即時狀態回饋
- **視覺一致性**: 統一的配色方案和元件樣式

### 技術規格
- **主視窗尺寸**: 900x550 像素
- **主要配色**:
  - 背景色: #2b2b2b (深灰)
  - 元件背景: #404040 (中灰)
  - 文字色: #ffffff (白色)
  - 強調色: #0078d4 (藍色)
  - 成功色: #00ff00 (綠色)
  - 預覽色: #87ceeb (淺藍)

## 佈局結構

### 整體佈局
```
┌─────────────────────────────────────────────────────────────────────┐
│ TMflow Security Report Generator v1.0.2.001            [─][□][×]   │
├─────────────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────┐ ┌─────────────────────────┐ │
│ │              左側主要區域              │ │        右側區域          │ │
│ │                                   │ │                       │ │
│ │ ┌─ Select Projects & Versions ─┐   │ │ ┌─ API Connection ──┐   │ │
│ │ │                             │   │ │ │                 │   │ │
│ │ │                             │   │ │ └─────────────────┘   │ │
│ │ │                             │   │ │                       │ │
│ │ │                             │   │ │ ┌─ Log ─────────────┐   │ │
│ │ │                             │   │ │ │                 │   │ │
│ │ │                             │   │ │ │                 │   │ │
│ │ └─────────────────────────────┘   │ │ │                 │   │ │
│ │                                   │ │ │                 │   │ │
│ │ ┌─ Report Options ─────────────┐   │ │ │                 │   │ │
│ │ │                             │   │ │ │                 │   │ │
│ │ └─────────────────────────────┘   │ │ │                 │   │ │
│ │                                   │ │ │                 │   │ │
│ │ ┌─ Progress ───────────────────┐   │ │ │                 │   │ │
│ │ │ ████████████████████ 0%     │   │ │ │                 │   │ │
│ │ └─────────────────────────────┘   │ │ └─────────────────┘   │ │
│ └─────────────────────────────────────┘ └─────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────┘
```

## 區域詳細設計

### 1. API Connection 區域 (右上角)

#### 功能描述
負責 FiniteState API 的連接設定和狀態管理，位於右側區域的上方。

#### 視覺設計
- **容器**: ttk.LabelFrame 帶有 "API Connection" 標題
- **邊框**: 實線邊框，深色主題
- **內邊距**: 10px
- **位置**: 右側區域頂部

#### 元件配置
```
┌─ API Connection ─────────────────────────────────────────┐
│ ● Connected  [Reconnect]                                │
│                                                         │
│ API Token:    [●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●] │
│ Subdomain:    [tm-robot                              ] │
│ Organization: [Techman Robot                         ] │
└─────────────────────────────────────────────────────────┘
```

#### 元件規格
- **狀態指示器**: 12x12px Canvas，綠色圓點表示已連接
- **輸入欄位**: 統一寬度 25 字元
- **Reconnect 按鈕**: 標準深色按鈕樣式，位於 Connected 文字右側
- **API Token**: 使用 `*` 遮罩顯示

### 2. Select Projects & Versions 區域 (左側上方，擴大)

#### 功能描述
顯示可用的專案和版本，支援批量選擇功能。此區域已擴大以顯示更多項目。

#### 視覺設計
- **容器**: ttk.LabelFrame 帶有 "Select Projects & Versions" 標題
- **可擴展**: 垂直方向可擴展，佔用左側大部分空間
- **內邊距**: 10px
- **高度**: Treeview 高度增加到 10 行

#### 元件配置
```
┌─ Select Projects & Versions ─────────────────────────────┐
│ [🔄 Refresh] [Select All] [Clear All]                   │
│                                                         │
│ Project/Version │Select│Version    │Project ID │Version ID│
│ ├─📁 TMflow     │     │          │          │         │
│ │ ├─📄 TMflow   │ ☐   │2025-12-19│117295502…│5069892…  │
│ │ ├─📄 TMflow   │ ☑   │2.26.1000.0│117295502…│8235615…  │
│ │ ├─📄 TMflow   │ ☐   │2.26.1200.0│117295502…│2501085…  │
│ │ └─📄 TMflow   │ ☐   │2.26.1200.0│117295502…│1936462…  │
│ ├─📁 TM AI+ Trainer│  │          │          │         │
│ │ ├─📄 TM AI+ Trainer│☐│1.0.0     │117295502…│1936462…  │
│ │ └─📄 TM AI+ Trainer│☐│1.1.0     │117295502…│1936462…  │
│                     │  │          │          │         │
│                     │  │          │          │         │
│                     │  │          │          │         │
│                     │  │          │          │         │
└─────────────────────────────────────────────────────────┘
```

#### 元件規格
- **Treeview**: 深色主題，支援選中高亮，高度 10 行
- **選擇欄**: 使用 ☐/☑ 符號表示選擇狀態
- **滾動條**: 垂直滾動支援
- **工具按鈕**: 標準深色按鈕樣式

### 3. Report Options 區域 (左側中間)

#### 功能描述
設定報告生成選項和輸出路徑。移除了 Include Timestamp 選項，因為時間戳總是包含。

#### 視覺設計
- **容器**: ttk.LabelFrame 帶有 "Report Options" 標題
- **內邊距**: 10px
- **佈局**: 三行式佈局

#### 元件配置
```
┌─ Report Options ─────────────────────────────────────────┐
│ ☑ Standard Report  ☑ Detailed Report    [Generate Reports]│
│                                                         │
│ Output: [D:\AI IDE\Kiro\FS ReportGenerator_v\reports\reports] [📁] │
│                                                         │
│ Preview: TMflow_2.26.0.0_Standard_[時間戳]...             │
└─────────────────────────────────────────────────────────┘
```

#### 元件規格
- **Checkbutton**: 原生 tkinter Checkbutton，深色主題
- **預設狀態**: Standard Report 和 Detailed Report 預設勾選
- **Generate Reports 按鈕**: 藍色高亮按鈕 (#0078d4)，位於第一行右側
- **Output 欄位**: 延伸到可用空間，使用 `fill=tk.X, expand=True`
- **檔名預覽**: 淺藍色文字 (#87ceeb)，總是包含時間戳

### 4. Progress 區域 (左側底部)

#### 功能描述
顯示報告生成進度和狀態，百分比顯示在進度條右側。

#### 視覺設計
- **容器**: ttk.LabelFrame 帶有 "Progress" 標題
- **位置**: 左側區域底部
- **內邊距**: 10px

#### 元件配置
```
┌─ Progress ───────────────────────────────────────────────┐
│ ████████████████████████████████████████████████ 0%     │
└─────────────────────────────────────────────────────────┘
```

#### 元件規格
- **進度條**: ttk.Progressbar，藍色填充 (#0078d4)
- **百分比標籤**: 位於進度條右側，預設顯示 0%
- **佈局**: 進度條和百分比在同一行

### 5. Log 區域 (右側下方，延伸到底部)

#### 功能描述
顯示應用程式運行日誌和操作記錄，延伸到視窗底部。

#### 視覺設計
- **容器**: ttk.LabelFrame 帶有 "Log" 標題
- **位置**: 右側區域下方，延伸到底部
- **內邊距**: 10px
- **擴展**: 垂直方向完全擴展

#### 元件配置
```
┌─ Log ─────────────────────┐
│ [15:21:19] 應用程式已啟動    │
│ [15:21:19] 請點擊 'Connect │
│ & Load Projects' 連接到   │
│ FiniteState API進行身份驗證 │
│ 以完成                   │
│ [15:28:17] 連接到         │
│ FiniteState              │
│ [15:28:19] 您的組織人員專案 │
│ 已完成的專案全: 載入人員     │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
│                         │
└─────────────────────────┘
```

#### 元件規格
- **文字區域**: ScrolledText，深色背景 (#404040)
- **文字顏色**: 白色 (#ffffff)
- **尺寸**: 無固定寬度限制，延伸到可用空間
- **滾動**: 自動滾動到最新訊息
- **擴展**: 使用 `fill=tk.BOTH, expand=True` 延伸到底部

## 互動設計

### 使用者操作流程
1. **啟動應用程式** → 載入預設配置，進度顯示 0%
2. **檢查 API 連接** → 綠色圓點表示已連接，Reconnect 按鈕在左側
3. **選擇專案版本** → 點擊 Select 欄位的 ☐ 切換為 ☑
4. **設定報告選項** → 選擇報告類型和輸出路徑（時間戳自動包含）
5. **生成報告** → 點擊右上角的 Generate Reports 按鈕
6. **監控進度** → 觀察進度條和右側百分比，以及日誌訊息

### 狀態回饋
- **連接狀態**: 綠色圓點 (已連接) / 黃色圓點 (連接中) / 紅色圓點 (未連接)
- **選擇狀態**: ☐ (未選擇) / ☑ (已選擇)
- **按鈕狀態**: 正常 / 停用 / 高亮
- **進度顯示**: 進度條 + 右側百分比文字，預設 0%

### 錯誤處理
- **警告對話框**: 當未選擇版本或報告類型時顯示
- **日誌記錄**: 所有操作和錯誤都記錄在右側日誌區域
- **狀態指示**: 透過顏色和文字提供即時回饋

## 樣式規範

### 色彩規範
| 用途 | 顏色代碼 | 說明 |
|------|---------|------|
| 主背景 | #2b2b2b | 深灰色，主要背景色 |
| 元件背景 | #404040 | 中灰色，輸入框和按鈕背景 |
| 文字 | #ffffff | 白色，主要文字色 |
| 強調 | #0078d4 | 藍色，重要按鈕和進度條 |
| 成功 | #00ff00 | 綠色，成功狀態指示 |
| 警告 | #ffff00 | 黃色，警告狀態指示 |
| 錯誤 | #ff0000 | 紅色，錯誤狀態指示 |
| 預覽 | #87ceeb | 淺藍色，檔名預覽文字 |

### 字型規範
- **標準字型**: 系統預設字型
- **按鈕字型**: Arial, 10pt, Bold (Generate Reports 按鈕)
- **進度標籤**: Arial, 9pt (百分比顯示)

### 間距規範
- **外邊距**: 15px (主要區域間距)
- **內邊距**: 10px (LabelFrame 內邊距)
- **元件間距**: 10px (相關元件間距)
- **小間距**: 5px (緊密相關元件間距)

## 響應式設計

### 視窗調整
- **預設尺寸**: 900x550px (寬度減少 100px)
- **可調整**: 支援水平和垂直調整
- **比例保持**: 左右區域比例約為 3:2

### 元件適應
- **專案列表**: 垂直方向可擴展，佔用左側大部分空間
- **日誌區域**: 垂直方向完全擴展到底部
- **進度條**: 水平方向自適應寬度
- **Output 欄位**: 水平方向延伸到可用空間

## 最新變更記錄 (v1.0.2.002)

### 🎯 重大功能更新
1. **實際 API 整合**: 
   - 整合真實的 Finite State API 調用
   - 使用正確的 API 端點: `/api/public/v0/projects`
   - 正確的認證方式: `X-Authorization` header

2. **動態專案載入**:
   - Refresh 按鈕現在能從 API 載入實際資料
   - 自動獲取 TMflow (21個版本) 和 TM AI+ Trainer (3個版本)
   - 實時版本資料更新

3. **API 功能完善**:
   - 背景執行緒處理 API 調用
   - 完善的錯誤處理和用戶提示
   - 詳細的 API 調用日誌記錄

### 📊 實際資料發現
- **TMflow 專案版本**: 3.12.1100.0, 2.26.1100.0, 2.26.1000.0, 3.12.1000.0, 3.12.1000_Vision 等
- **TM AI+ Trainer 版本**: 2025-12-19, 2.26.1000.0, 2.26.1100.0
- **正確的版本 ID**: 使用實際的 Finite State 版本 ID 格式

### 🛠️ 技術改進
- **API 測試工具**: 新增 test_api.py 用於 API 驗證
- **錯誤處理**: 針對不同 HTTP 狀態碼的具體錯誤訊息
- **資料結構**: 正確解析 Finite State API 回應格式

---

## 最新變更記錄 (v2.0)

### 佈局調整
1. **視窗尺寸**: 從 1000x600 調整為 900x550
2. **API Connection**: 移至右上角，Reconnect 按鈕左移
3. **Select Projects**: 擴大顯示區域，Treeview 高度增加到 10 行
4. **Report Options**: 移除 Include Timestamp 選項，Generate Reports 按鈕移至右上角
5. **Progress**: 百分比移至進度條右側，預設值改為 0%
6. **Log**: 延伸到視窗底部，移除寬度限制

### 功能調整
1. **時間戳**: 總是包含在報告檔名中，不再提供選項
2. **進度顯示**: 預設從 0% 開始，而非 85%
3. **輸入欄位**: Output 欄位延伸到可用空間
4. **API 欄位**: 寬度統一調整為 25 字元

### 視覺優化
1. **空間利用**: 更好的空間分配，Select 區域更大
2. **按鈕位置**: Generate Reports 按鈕位置更直觀
3. **進度顯示**: 進度條和百分比在同一行，節省空間
4. **日誌區域**: 完全延伸到底部，提供更多日誌顯示空間

---

**文件維護**: 本文件應隨著 UI 設計的變更而及時更新，確保文件與實際實作保持一致。